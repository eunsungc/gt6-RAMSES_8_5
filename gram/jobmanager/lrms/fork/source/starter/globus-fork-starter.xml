<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
"http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd">
<!-- Canonical version of this document lives in 
$Header$
-->


<refentry id="gram5-globus-fork-starter">
<refmeta>
<refentrytitle>globus-fork-starter</refentrytitle>
<manvolnum>8</manvolnum>
<refmiscinfo class="author">University of Chicago</refmiscinfo>
</refmeta>

<refnamediv>
<refname>globus-fork-starter</refname>
<refpurpose>Start and monitor a fork job</refpurpose>
</refnamediv>
<refsynopsisdiv>
<cmdsynopsis>
<command>globus-fork-starter</command>
</cmdsynopsis>
</refsynopsisdiv>

<refsect1><title>Description</title>
<para>
The <command>globus-fork-starter</command> program is executes jobs
specified on its standard input stream, recording the job state changes
to a file defined in the
<filename><envar>$GLOBUS_LOCATION</envar>/etc/globus-fork.conf</filename>
configuration file. It runs until its standard input stream is closed and
all jobs it is managing have terminated. The log generated by this program 
can be used by the SEG to provide job state changes and exit codes to the
GRAM service.  The <command>globus-fork-starter</command> program is typically
started by the fork GRAM module.
</para>

<para>
The <command>globus-fork-starter</command> program expects its input to be
a series of task definitions, separated by the newline character, each
representing a separate job.  Each task definition contains a number of fields,
separated by the colon character. The first field is always the literal string
<literal>100</literal> indicating the message format, the second field is
a unique job tag that will be distinguish the reply from this program
when multiple jobs are submitted.  The rest of fields contain attribute
bindings. The supported attributes
are:
<variablelist>
    <varlistentry>
        <term><literal>directory</literal></term>
        <listitem><simpara>Working directory of the job</simpara></listitem>
    </varlistentry>
    <varlistentry>
        <term><literal>environment</literal></term>
        <listitem><simpara>Comma-separated list of strings defining environment
        variables. The form of these strings is <literal>var=value</literal></simpara></listitem>
    </varlistentry>
    <varlistentry>
        <term><literal>count</literal></term>
        <listitem><simpara>Number of processes to start</simpara></listitem>
    </varlistentry>
    <varlistentry>
        <term><literal>executable</literal></term>
        <listitem><simpara>Full path to the executable to run</simpara></listitem>
    </varlistentry>
    <varlistentry>
        <term><literal>arguments</literal></term>
        <listitem><simpara>Comma-separated list of command-line arguments for the job</simpara></listitem>
    </varlistentry>
    <varlistentry>
        <term><literal>stdin</literal></term>
        <listitem><simpara>Full path to a file containing the input of the job</simpara></listitem>
    </varlistentry>
    <varlistentry>
        <term><literal>stdout</literal></term>
        <listitem><simpara>Full path to a file to write the output of the job to</simpara></listitem>
    </varlistentry>
    <varlistentry>
        <term><literal>stderr</literal></term>
        <listitem><simpara>Full path to a file to write the error stream of the job</simpara></listitem>
    </varlistentry>
</variablelist>
</para>
<para>
Within each field, the following characters may be escaped by preceding them
with the backslash character:
<itemizedlist>
    <listitem><simpara>backslash (\)</simpara></listitem>
    <listitem><simpara>semicolor (;)</simpara></listitem>
    <listitem><simpara>comma (,)</simpara></listitem>
    <listitem><simpara>equal (=)</simpara></listitem>
</itemizedlist>
Additionally, newline can be represented within a field by using the escape
sequence \n.
</para>
<para>
For each job the <command>globus-fork-starter</command> processes, it replies
by writing a single line to standard output. The replies again consist of
a number of fields separated by the semicolon character.
</para>
<para>
For a successful job start, the first field of the reply is the literal
<literal>101</literal>, the second field is the tag from the input, and the
third field is a comma-separated list of SEG job identifiers which consist the
concatenation of a UUID and a process id. The
<command>globus-fork-starter</command> program will write state changes to the
SEG log using these job identifiers.
</para>
<para>
For a failure, the first field of the reply is the literal
<literal>102</literal>, the second field is the tag from the input, the
third field is the integer representation of a GRAM erorr code, and the
fourth field is an string explaining the error.
</para>
</refsect1>

<refsect1><title>ENVIRONMENT</title>
<para>
If the following variables affect the execution of <command>globus-fork-starter</command>

<variablelist>
    <varlistentry>
        <term>GLOBUS_LOCATION</term>
        <listitem><simpara>Path to Globus Toolkit installation. This is used to locate the <filename>globus-fork.conf</filename> configuration file.</simpara></listitem>
    </varlistentry>
</variablelist>
</para>
</refsect1>

<refsect1><title>Files</title>
<para>
<variablelist>
    <varlistentry>
        <term><filename><envar>$GLOBUS_LOCATION</envar>/etc/globus-fork.conf</filename></term>
        <listitem><simpara>Path to fork SEG configuration file.</simpara></listitem>
    </varlistentry>
</variablelist>
</para>
</refsect1>

</refentry>
